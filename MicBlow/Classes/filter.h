//关于滤波器
#define LPF1
//#define NOFILTER

//#define N_fil  81//滤波器阶数

#ifdef HPF1

#define N_fil  111//滤波器阶数
const float b_filter[1000]={0   ,   
0.00003 ,
0.00011 ,
0.00014 ,
0       ,
-0.00033,
-0.00066,
-0.00062,
0       ,
0.00101 ,
0.00178 ,
0.00153 ,
0       ,
-0.00218,
-0.00362,
-0.00298,
0       ,
0.00396 ,
0.0064  ,
0.00515 ,
0       ,
-0.0066 ,
-0.01053,
-0.00837,
0       ,
0.01057 ,
0.0168  ,
0.01336 ,
0       ,
-0.01704,
-0.02738,
-0.02215,
0       ,
0.0299  ,
0.0503  ,
0.04338 ,
    
    0       ,  
    -0.00033,
    -0.00066,
    -0.00062,
    0       ,
    0.00101 ,
    0.00178 ,
    0.00153 ,
    0       ,
    -0.00218,
    -0.00362,
    -0.00298,
    
    
    
0       ,
-0.02215,
-0.02738,
-0.01704,
0       ,
0.01336 ,
0.0168  ,
0.01057 ,
0       ,
-0.00837,
-0.01053,
-0.0066 ,
0       ,
0.00515 ,
0.0064  ,
0.00396 ,
0       ,
-0.00298,
-0.00362,
-0.00218,
0       ,
0.00153 ,
0.00178 ,
0.00101 ,
0       ,
-0.00062,
-0.00066,
-0.00033,
0       ,
0.00014 ,
0.00011 ,
0.00003 ,
0       };
#endif

#ifdef LPF1
#define N_fil  111//滤波器阶数
const float b_filter[1000]= 

{
    -0.0329,
    0.00781,
    0.0071 ,
    0.00658,
    0.0062 ,
    0.00595,
    0.0058 ,
    0.00574,
    0.00575,
    0.00582,
    0.00595,
    0.00612,
    0.00633,
    0.00658,
    0.00685,
    0.00715,
    0.00746,
    0.00779,
    0.00814,
    0.0085 ,
    0.00886,
    0.00924,
    0.00962,
    0.01001,
    0.01039,
    0.01079,
    0.01117,
    0.01156,
    0.01195,
    0.01234,
    0.01271,
    0.01308,
    0.01345,
    0.0138 ,
    0.01415,
    0.01449,
    0.01481,
    0.01513,
    0.01543,
    0.01572,
    0.016  ,
    0.01626,
    0.01652,
    0.01672,
    0.01697,
    0.01717,
    0.01733,
    0.01748,
    0.01764,
    0.01777,
    0.01788,
    0.01796,
    0.01803,
    0.01808,
    0.01811,
    0.01812,
    0.01811,
    0.01808,
    0.01803,
    0.01796,
    0.01788,
    0.01777,
    0.01764,
    0.01748,
    0.01733,
    0.01717,
    0.01697,
    0.01672,
    0.01652,
    0.01626,
    0.016  ,
    0.01572,
    0.01543,
    0.01513,
    0.01481,
    0.01449,
    0.01415,
    0.0138 ,
    0.01345,
    0.01308,
    0.01271,
    0.01234,
    0.01195,
    0.01156,
    0.01117,
    0.01079,
    0.01039,
    0.01001,
    0.00962,
    0.00924,
    0.00886,
    0.0085 ,
    0.00814,
    0.00779,
    0.00746,
    0.00715,
    0.00685,
    0.00658,
    0.00633,
    0.00612,
    0.00595,
    0.00582,
    0.00575,
    0.00574,
    0.0058 ,
    0.00595,
    0.0062 ,
    0.00658,
    0.0071 ,
    0.00781,
    -0.0329
};
#endif
#ifdef NOFILTER
#define N_fil  1//滤波器阶数
const float b_filter[1000]={1 };
#endif


S16 data_pre[N_fil]={0};
S16 data_now[N_fil]={0};
S16 *datain;
S16 *dataout;

void filter(S16 *datai,int datalen,S16 *datao,float bfilter[],S16 blen)//滤波器主函数。datai为输入数组地址，datalen为输入数组中数据个数，datao为输出数组地址，bfilter为滤波器系数数组，blen为阶数
{   


	int i,j;
	
	for(i=0;i<blen-1;i++)data_pre[i]=data_now[i];


	for(i=datalen;i<datalen+blen-1;i++)*(datai+i)=0;  


	for(i=0;i<datalen+blen-1;i++){

		//printf("%d\n",pcmdata[i]);//
		for(j=0;j<blen;j++)if(i>=j)*(datao+i)+=*(datai+i-j)*bfilter[j];
		if(i<blen-1)*(datao+i)+=data_pre[i];
	    if(i>=datalen)data_now[i-datalen]=*(datao+i);
	}

	
	



}


/*
 
 -0.0329,
 0.00781,
 0.0071 ,
 0.00658,
 0.0062 ,
 0.00595,
 0.0058 ,
 0.00574,
 0.00575,
 0.00582,
 0.00595,
 0.00612,
 0.00633,
 0.00658,
 0.00685,
 0.00715,
 0.00746,
 0.00779,
 0.00814,
 0.0085 ,
 0.00886,
 0.00924,
 0.00962,
 0.01001,
 0.01039,
 0.01079,
 0.01117,
 0.01156,
 0.01195,
 0.01234,
 0.01271,
 0.01308,
 0.01345,
 0.0138 ,
 0.01415,
 0.01449,
 0.01481,
 0.01513,
 0.01543,
 0.01572,
 0.016  ,
 0.01626,
 0.01652,
 0.01672,
 0.01697,
 0.01717,
 0.01733,
 0.01748,
 0.01764,
 0.01777,
 0.01788,
 0.01796,
 0.01803,
 0.01808,
 0.01811,
 0.01812,
 0.01811,
 0.01808,
 0.01803,
 0.01796,
 0.01788,
 0.01777,
 0.01764,
 0.01748,
 0.01733,
 0.01717,
 0.01697,
 0.01672,
 0.01652,
 0.01626,
 0.016  ,
 0.01572,
 0.01543,
 0.01513,
 0.01481,
 0.01449,
 0.01415,
 0.0138 ,
 0.01345,
 0.01308,
 0.01271,
 0.01234,
 0.01195,
 0.01156,
 0.01117,
 0.01079,
 0.01039,
 0.01001,
 0.00962,
 0.00924,
 0.00886,
 0.0085 ,
 0.00814,
 0.00779,
 0.00746,
 0.00715,
 0.00685,
 0.00658,
 0.00633,
 0.00612,
 0.00595,
 0.00582,
 0.00575,
 0.00574,
 0.0058 ,
 0.00595,
 0.0062 ,
 0.00658,
 0.0071 ,
 0.00781,
 -0.0329
 */
